<?xml version="1.0" encoding="utf-8"?>
<Project xmlns="http://schemas.microsoft.com/developer/msbuild/2003">
  <!-- the following VS.net project references
	     are provided to allow for correct compilation
		 of VS projects that target both .NET 3.5 and 4.5
		 in the same solution by using SharePoint 2010/2013
		 
		 Usage: include this file and comment out the lines
		 created by Nuget package manager. Note that from
		 time to time you may need to update the package path.
		 -->

  <!-- SET UP VARIABLES -->
  <Choose>
    <When Condition="$(TargetFrameworkVersion.Contains('v3.5')) OR $(Configuration.Contains('SP14')) OR $(Configuration.Contains('_14'))">
      <PropertyGroup>
        <KrakenCoreVersion>3.5</KrakenCoreVersion>
        <KrakenSharePointVersion>14</KrakenSharePointVersion>
      </PropertyGroup>
    </When>
    <When Condition="($(TargetFrameworkVersion.Contains('v4.5')) OR $(TargetFrameworkVersion.Contains('v4.6'))) AND ($(Configuration.Contains('SP16')) OR $(Configuration.Contains('_16')))">
      <PropertyGroup>
        <KrakenCoreVersion>4.5</KrakenCoreVersion>
        <KrakenSharePointVersion>16</KrakenSharePointVersion>
      </PropertyGroup>
    </When>
    <When Condition="($(TargetFrameworkVersion.Contains('v4.5')) OR $(TargetFrameworkVersion.Contains('v4.6'))) AND ($(Configuration.Contains('SP15')) OR $(Configuration.Contains('_15')))">
      <PropertyGroup>
        <KrakenCoreVersion>4.5</KrakenCoreVersion>
        <KrakenSharePointVersion>15</KrakenSharePointVersion>
      </PropertyGroup>
    </When>
  </Choose>

  <Choose>
    <!-- for bizzarre reasons we are still trying to figure out,
	     this seems to work better than the proper methods. -->
    <When Condition="$(KrakenRef.Contains('SimpleCore'))">
      <ItemGroup>
        <Reference Include="Kraken.Core.FullTrust">
          <SpecificVersion>False</SpecificVersion>
          <HintPath Condition="'$(Configuration)' == 'Debug35' OR '$(Configuration)' == 'FxCop35'">..\packages\Kraken.SharePoint.Client.0.1.10\lib\net35-full\Kraken.Core.FullTrust.dll</HintPath>
          <HintPath Condition="'$(Configuration)' == 'Debug40' OR '$(Configuration)' == 'FxCop40'">..\packages\Kraken.SharePoint.Client.0.1.10\lib\net40-full\Kraken.Core.FullTrust.dll</HintPath>
          <HintPath Condition="'$(Configuration)' == 'Debug45' OR '$(Configuration)' == 'FxCop45'">..\packages\Kraken.SharePoint.Client.0.1.10\lib\net45-full\Kraken.Core.FullTrust.dll</HintPath>
          <HintPath Condition="'$(Configuration)' == 'Release35'">..\packages\Kraken.SharePoint.Client.0.1.10\lib\net35-full\Kraken.Core.FullTrust.dll</HintPath>
          <HintPath Condition="'$(Configuration)' == 'Release40'">..\packages\Kraken.SharePoint.Client.0.1.10\lib\net40-full\Kraken.Core.FullTrust.dll</HintPath>
          <HintPath Condition="'$(Configuration)' == 'Release45'">..\packages\Kraken.SharePoint.Client.0.1.10\lib\net45-full\Kraken.Core.FullTrust.dll</HintPath>
          <Private>True</Private>
        </Reference>
        <Reference Include="Kraken.Core.SandboxTrust">
          <SpecificVersion>False</SpecificVersion>
          <HintPath Condition="'$(Configuration)' == 'Debug35' OR '$(Configuration)' == 'FxCop35'">..\packages\Kraken.SharePoint.Client.0.1.10\lib\net35-full\Kraken.Core.SandboxTrust.dll</HintPath>
          <HintPath Condition="'$(Configuration)' == 'Debug40' OR '$(Configuration)' == 'FxCop40'">..\packages\Kraken.SharePoint.Client.0.1.10\lib\net40-full\Kraken.Core.SandboxTrust.dll</HintPath>
          <HintPath Condition="'$(Configuration)' == 'Debug45' OR '$(Configuration)' == 'FxCop45'">..\packages\Kraken.SharePoint.Client.0.1.10\lib\net45-full\Kraken.Core.SandboxTrust.dll</HintPath>
          <HintPath Condition="'$(Configuration)' == 'Release35'">..\packages\Kraken.SharePoint.Client.0.1.10\lib\net35-full\Kraken.Core.SandboxTrust.dll</HintPath>
          <HintPath Condition="'$(Configuration)' == 'Release40'">..\packages\Kraken.SharePoint.Client.0.1.10\lib\net40-full\Kraken.Core.SandboxTrust.dll</HintPath>
          <HintPath Condition="'$(Configuration)' == 'Release45'">..\packages\Kraken.SharePoint.Client.0.1.10\lib\net45-full\Kraken.Core.SandboxTrust.dll</HintPath>
          <Private>True</Private>
        </Reference>
        <Reference Include="Kraken.Security">
          <SpecificVersion>False</SpecificVersion>
          <HintPath Condition="'$(Configuration)' == 'Debug35' OR '$(Configuration)' == 'FxCop35'">..\packages\Kraken.SharePoint.Client.0.1.10\lib\net35-full\Kraken.Security.dll</HintPath>
          <HintPath Condition="'$(Configuration)' == 'Debug40' OR '$(Configuration)' == 'FxCop40'">..\packages\Kraken.SharePoint.Client.0.1.10\lib\net40-full\Kraken.Security.dll</HintPath>
          <HintPath Condition="'$(Configuration)' == 'Debug45' OR '$(Configuration)' == 'FxCop45'">..\packages\Kraken.SharePoint.Client.0.1.10\lib\net45-full\Kraken.Security.dll</HintPath>
          <HintPath Condition="'$(Configuration)' == 'Release35'">..\packages\Kraken.SharePoint.Client.0.1.10\lib\net35-full\Kraken.Security.dll</HintPath>
          <HintPath Condition="'$(Configuration)' == 'Release40'">..\packages\Kraken.SharePoint.Client.0.1.10\lib\net40-full\Kraken.Security.dll</HintPath>
          <HintPath Condition="'$(Configuration)' == 'Release45'">..\packages\Kraken.SharePoint.Client.0.1.10\lib\net45-full\Kraken.Security.dll</HintPath>
          <Private>True</Private>
        </Reference>
      </ItemGroup>
    </When>
    <When Condition="$(KrakenRef.Contains('FullCore'))">

      <Choose>
        <!-- Debug and FxCop -->
        <When Condition="$(KrakenCoreVersion.Contains('4.5')) AND ($(Configuration.Contains('Debug')) OR $(Configuration.Contains('FxCop')))">
          <ItemGroup>
            <Reference Include="Kraken.Core.FullTrust, Version=4.5.0.0, Culture=neutral, PublicKeyToken=5e6c79b1689163cb, processorArchitecture=MSIL">
              <SpecificVersion>true</SpecificVersion>
              <HintPath>..\packages\Kraken.SharePoint.Client.0.1.10\lib\net45-full\Kraken.Core.FullTrust.dll</HintPath>
              <Private>True</Private>
            </Reference>
            <Reference Include="Kraken.Core.SandboxTrust, Version=4.5.0.0, Culture=neutral, PublicKeyToken=5e6c79b1689163cb, processorArchitecture=MSIL">
              <SpecificVersion>true</SpecificVersion>
              <HintPath>..\packages\Kraken.SharePoint.Client.0.1.10\lib\net45-full\Kraken.Core.SandboxTrust.dll</HintPath>
              <Private>True</Private>
            </Reference>
            <Reference Include="Kraken.Security, Version=4.5.0.0, Culture=neutral, PublicKeyToken=6507051e0d5be117, processorArchitecture=MSIL">
              <SpecificVersion>true</SpecificVersion>
              <HintPath>..\packages\Kraken.SharePoint.Client.0.1.10\lib\net45-full\Kraken.Security.dll</HintPath>
              <Private>True</Private>
            </Reference>
          </ItemGroup>
        </When>
        <When Condition="$(KrakenCoreVersion.Contains('3.5')) AND ($(Configuration.Contains('Debug')) OR $(Configuration.Contains('FxCop')))">
          <ItemGroup>
            <Reference Include="Kraken.Core.FullTrust, Version=3.5.0.0, Culture=neutral, PublicKeyToken=5e6c79b1689163cb, processorArchitecture=MSIL">
              <SpecificVersion>true</SpecificVersion>
              <HintPath>..\packages\Kraken.SharePoint.Client.0.1.10\lib\net35-full\Kraken.Core.FullTrust.dll</HintPath>
              <Private>True</Private>
            </Reference>
            <Reference Include="Kraken.Core.SandboxTrust, Version=3.5.0.0, Culture=neutral, PublicKeyToken=5e6c79b1689163cb, processorArchitecture=MSIL">
              <SpecificVersion>true</SpecificVersion>
              <HintPath>..\packages\Kraken.SharePoint.Client.0.1.10\lib\net35-full\Kraken.Core.SandboxTrust.dll</HintPath>
              <Private>True</Private>
            </Reference>
            <Reference Include="Kraken.Security, Version=3.5.0.0, Culture=neutral, PublicKeyToken=6507051e0d5be117, processorArchitecture=MSIL">
              <SpecificVersion>true</SpecificVersion>
              <HintPath>..\packages\Kraken.SharePoint.Client.0.1.10\lib\net35-full\Kraken.Security.dll</HintPath>
              <Private>True</Private>
            </Reference>
          </ItemGroup>
        </When>
        <!-- Release -->
        <When Condition="$(KrakenCoreVersion.Contains('4.5')) AND $(Configuration.Contains('Release'))">
          <ItemGroup>
            <Reference Include="Kraken.Core.FullTrust, Version=4.5.0.0, Culture=neutral, PublicKeyToken=5e6c79b1689163cb, processorArchitecture=MSIL">
              <SpecificVersion>true</SpecificVersion>
              <HintPath>..\packages\Kraken.SharePoint.Client.0.1.10\lib\net45-full\Kraken.Core.FullTrust.dll</HintPath>
              <Private>True</Private>
            </Reference>
            <Reference Include="Kraken.Core.SandboxTrust, Version=4.5.0.0, Culture=neutral, PublicKeyToken=5e6c79b1689163cb, processorArchitecture=MSIL">
              <SpecificVersion>true</SpecificVersion>
              <HintPath>..\packages\Kraken.SharePoint.Client.0.1.10\lib\net45-full\Kraken.Core.SandboxTrust.dll</HintPath>
              <Private>True</Private>
            </Reference>
            <Reference Include="Kraken.Security, Version=4.5.0.0, Culture=neutral, PublicKeyToken=6507051e0d5be117, processorArchitecture=MSIL">
              <SpecificVersion>true</SpecificVersion>
              <HintPath>..\packages\Kraken.SharePoint.Client.0.1.10\lib\net45-full\Kraken.Security.dll</HintPath>
              <Private>True</Private>
            </Reference>
          </ItemGroup>
        </When>
        <When Condition="$(KrakenCoreVersion.Contains('3.5')) AND $(Configuration.Contains('Release'))">
          <ItemGroup>
            <Reference Include="Kraken.Core.FullTrust, Version=3.5.0.0, Culture=neutral, PublicKeyToken=5e6c79b1689163cb, processorArchitecture=MSIL">
              <SpecificVersion>true</SpecificVersion>
              <HintPath>..\packages\Kraken.SharePoint.Client.0.1.10\lib\net35-full\Kraken.Core.FullTrust.dll</HintPath>
              <Private>True</Private>
            </Reference>
            <Reference Include="Kraken.Core.SandboxTrust, Version=3.5.0.0, Culture=neutral, PublicKeyToken=5e6c79b1689163cb, processorArchitecture=MSIL">
              <SpecificVersion>true</SpecificVersion>
              <HintPath>..\packages\Kraken.SharePoint.Client.0.1.10\lib\net35-full\Kraken.Core.SandboxTrust.dll</HintPath>
              <Private>True</Private>
            </Reference>
            <Reference Include="Kraken.Security, Version=3.5.0.0, Culture=neutral, PublicKeyToken=6507051e0d5be117, processorArchitecture=MSIL">
              <SpecificVersion>true</SpecificVersion>
              <HintPath>..\packages\Kraken.SharePoint.Client.0.1.10\lib\net35-full\Kraken.Security.dll</HintPath>
              <Private>True</Private>
            </Reference>
          </ItemGroup>
        </When>
        <!-- contigency this is required so that the references will actually appear in Visual Studio -->
        <Otherwise>
          <ItemGroup>
            <!-- when the system is being moronic, use the oldest version -->
            <Reference Include="Kraken.Core.FullTrust">
              <SpecificVersion>false</SpecificVersion>
              <HintPath>..\packages\Kraken.SharePoint.Client.0.1.10\lib\net35-full\Kraken.Core.FullTrust.dll</HintPath>
              <Private>True</Private>
            </Reference>
            <Reference Include="Kraken.Core.SandboxTrust">
              <SpecificVersion>false</SpecificVersion>
              <HintPath>..\packages\Kraken.SharePoint.Client.0.1.10\lib\net35-full\Kraken.Core.SandboxTrust.dll</HintPath>
              <Private>True</Private>
            </Reference>
            <Reference Include="Kraken.Security">
              <SpecificVersion>false</SpecificVersion>
              <HintPath>..\packages\Kraken.SharePoint.Client.0.1.10\lib\net35-full\Kraken.Security.dll</HintPath>
              <Private>True</Private>
            </Reference>
          </ItemGroup>
        </Otherwise>
      </Choose>

    </When>
    <When Condition="$(KrakenRef.Contains('SandboxCore'))">

      <Choose>
        <!-- Debug and FxCop -->
        <When Condition="$(KrakenCoreVersion.Contains('4.5')) AND ($(Configuration.Contains('Debug')) OR $(Configuration.Contains('FxCop')))">
          <ItemGroup>
            <Reference Include="Kraken.Core.SandboxTrust, Version=4.5.0.0, Culture=neutral, PublicKeyToken=5e6c79b1689163cb, processorArchitecture=MSIL">
              <SpecificVersion>true</SpecificVersion>
              <HintPath>..\packages\Kraken.SharePoint.Client.0.1.10\lib\net45-full\Kraken.Core.SandboxTrust.dll</HintPath>
              <Private>True</Private>
            </Reference>
            <Reference Include="Kraken.Security, Version=4.5.0.0, Culture=neutral, PublicKeyToken=6507051e0d5be117, processorArchitecture=MSIL">
              <SpecificVersion>true</SpecificVersion>
              <HintPath>..\packages\Kraken.SharePoint.Client.0.1.10\lib\net45-full\Kraken.Security.dll</HintPath>
              <Private>True</Private>
            </Reference>
          </ItemGroup>
        </When>
        <When Condition="$(KrakenCoreVersion.Contains('3.5')) AND ($(Configuration.Contains('Debug')) OR $(Configuration.Contains('FxCop')))">
          <ItemGroup>
            <Reference Include="Kraken.Core.SandboxTrust, Version=3.5.0.0, Culture=neutral, PublicKeyToken=5e6c79b1689163cb, processorArchitecture=MSIL">
              <SpecificVersion>true</SpecificVersion>
              <HintPath>..\packages\Kraken.SharePoint.Client.0.1.10\lib\net35-full\Kraken.Core.SandboxTrust.dll</HintPath>
              <Private>True</Private>
            </Reference>
            <Reference Include="Kraken.Security, Version=3.5.0.0, Culture=neutral, PublicKeyToken=6507051e0d5be117, processorArchitecture=MSIL">
              <SpecificVersion>true</SpecificVersion>
              <HintPath>..\packages\Kraken.SharePoint.Client.0.1.10\lib\net35-full\Kraken.Security.dll</HintPath>
              <Private>True</Private>
            </Reference>
          </ItemGroup>
        </When>
        <!-- Release -->
        <When Condition="$(KrakenCoreVersion.Contains('4.5')) AND $(Configuration.Contains('Release'))">
          <ItemGroup>
            <Reference Include="Kraken.Core.SandboxTrust, Version=4.5.0.0, Culture=neutral, PublicKeyToken=5e6c79b1689163cb, processorArchitecture=MSIL">
              <SpecificVersion>true</SpecificVersion>
              <HintPath>..\packages\Kraken.SharePoint.Client.0.1.10\lib\net45-full\Kraken.Core.SandboxTrust.dll</HintPath>
              <Private>True</Private>
            </Reference>
            <Reference Include="Kraken.Security, Version=4.5.0.0, Culture=neutral, PublicKeyToken=6507051e0d5be117, processorArchitecture=MSIL">
              <SpecificVersion>true</SpecificVersion>
              <HintPath>..\packages\Kraken.SharePoint.Client.0.1.10\lib\net45-full\Kraken.Security.dll</HintPath>
              <Private>True</Private>
            </Reference>
          </ItemGroup>
        </When>
        <When Condition="$(KrakenCoreVersion.Contains('3.5')) AND $(Configuration.Contains('Release'))">
          <ItemGroup>
            <Reference Include="Kraken.Core.SandboxTrust, Version=3.5.0.0, Culture=neutral, PublicKeyToken=5e6c79b1689163cb, processorArchitecture=MSIL">
              <SpecificVersion>true</SpecificVersion>
              <HintPath>..\packages\Kraken.SharePoint.Client.0.1.10\lib\net35-full\Kraken.Core.SandboxTrust.dll</HintPath>
              <Private>True</Private>
            </Reference>
            <Reference Include="Kraken.Security, Version=3.5.0.0, Culture=neutral, PublicKeyToken=6507051e0d5be117, processorArchitecture=MSIL">
              <SpecificVersion>true</SpecificVersion>
              <HintPath>..\packages\Kraken.SharePoint.Client.0.1.10\lib\net35-full\Kraken.Security.dll</HintPath>
              <Private>True</Private>
            </Reference>
          </ItemGroup>
        </When>
        <!-- contigency this is required so that the references will actually appear in Visual Studio -->
        <Otherwise>
          <ItemGroup>
            <!-- when the system is being moronic, use the oldest version -->
            <Reference Include="Kraken.Core.SandboxTrust">
              <SpecificVersion>false</SpecificVersion>
              <HintPath>..\packages\Kraken.SharePoint.Client.0.1.10\lib\net35-full\Kraken.Core.SandboxTrust.dll</HintPath>
              <Private>True</Private>
            </Reference>
            <Reference Include="Kraken.Security">
              <SpecificVersion>false</SpecificVersion>
              <HintPath>..\packages\Kraken.SharePoint.Client.0.1.10\lib\net35-full\Kraken.Security.dll</HintPath>
              <Private>True</Private>
            </Reference>
          </ItemGroup>
        </Otherwise>
      </Choose>

    </When>
  </Choose>

  <Choose>
    <When Condition="$(KrakenRef.Contains('FullSharePoint'))">

      <Choose>
        <!-- TODO need v16 references -->
        <!-- Debug and FxCop -->
        <When Condition="$(KrakenSharePointVersion.Contains('15')) AND ($(Configuration.Contains('Debug')) OR $(Configuration.Contains('FxCop')))">
          <ItemGroup>
            <Reference Include="Kraken.SharePoint.FullTrust, Version=15.0.0.0, Culture=neutral, PublicKeyToken=3cf55a8425a3a2ff, processorArchitecture=MSIL">
              <SpecificVersion>true</SpecificVersion>
              <HintPath>..\packages\Kraken.SharePoint.Client.0.1.10\lib\net45-full\Kraken.SharePoint.FullTrust.dll</HintPath>
              <Private>True</Private>
            </Reference>
            <Reference Include="Kraken.SharePoint.SandboxTrust, Version=15.0.0.0, Culture=neutral, PublicKeyToken=3cf55a8425a3a2ff, processorArchitecture=MSIL">
              <SpecificVersion>true</SpecificVersion>
              <HintPath>..\packages\Kraken.SharePoint.Client.0.1.10\lib\net45-full\Kraken.SharePoint.SandboxTrust.dll</HintPath>
              <Private>True</Private>
            </Reference>
          </ItemGroup>
        </When>
        <When Condition="$(KrakenSharePointVersion.Contains('14')) AND ($(Configuration.Contains('Debug')) OR $(Configuration.Contains('FxCop')))">
          <ItemGroup>
            <Reference Include="Kraken.SharePoint.FullTrust, Version=14.0.0.0, Culture=neutral, PublicKeyToken=3cf55a8425a3a2ff, processorArchitecture=MSIL">
              <SpecificVersion>true</SpecificVersion>
              <HintPath>..\packages\Kraken.SharePoint.Client.0.1.10\lib\net35-full\Kraken.SharePoint.FullTrust.dll</HintPath>
              <Private>True</Private>
            </Reference>
            <Reference Include="Kraken.SharePoint.SandboxTrust, Version=14.0.0.0, Culture=neutral, PublicKeyToken=3cf55a8425a3a2ff, processorArchitecture=MSIL">
              <SpecificVersion>true</SpecificVersion>
              <HintPath>..\packages\Kraken.SharePoint.Client.0.1.10\lib\net35-full\Kraken.SharePoint.SandboxTrust.dll</HintPath>
              <Private>True</Private>
            </Reference>
          </ItemGroup>
        </When>
        <!-- Release -->
        <When Condition="$(KrakenSharePointVersion.Contains('15')) AND $(Configuration.Contains('Release'))">
          <ItemGroup>
            <Reference Include="Kraken.SharePoint.FullTrust, Version=15.0.0.0, Culture=neutral, PublicKeyToken=3cf55a8425a3a2ff, processorArchitecture=MSIL">
              <SpecificVersion>true</SpecificVersion>
              <HintPath>..\packages\Kraken.SharePoint.Client.0.1.10\lib\net45-full\Kraken.SharePoint.FullTrust.dll</HintPath>
              <Private>True</Private>
            </Reference>
            <Reference Include="Kraken.SharePoint.SandboxTrust, Version=15.0.0.0, Culture=neutral, PublicKeyToken=3cf55a8425a3a2ff, processorArchitecture=MSIL">
              <SpecificVersion>true</SpecificVersion>
              <HintPath>..\packages\Kraken.SharePoint.Client.0.1.10\lib\net45-full\Kraken.SharePoint.SandboxTrust.dll</HintPath>
              <Private>True</Private>
            </Reference>
          </ItemGroup>
        </When>
        <When Condition="$(KrakenSharePointVersion.Contains('14')) AND $(Configuration.Contains('Release'))">
          <ItemGroup>
            <Reference Include="Kraken.SharePoint.FullTrust, Version=14.0.0.0, Culture=neutral, PublicKeyToken=3cf55a8425a3a2ff, processorArchitecture=MSIL">
              <SpecificVersion>true</SpecificVersion>
              <HintPath>..\packages\Kraken.SharePoint.Client.0.1.10\lib\net35-full\Kraken.SharePoint.FullTrust.dll</HintPath>
              <Private>True</Private>
            </Reference>
            <Reference Include="Kraken.SharePoint.SandboxTrust, Version=14.0.0.0, Culture=neutral, PublicKeyToken=3cf55a8425a3a2ff, processorArchitecture=MSIL">
              <SpecificVersion>true</SpecificVersion>
              <HintPath>..\packages\Kraken.SharePoint.Client.0.1.10\lib\net35-full\Kraken.SharePoint.SandboxTrust.dll</HintPath>
              <Private>True</Private>
            </Reference>
          </ItemGroup>
        </When>
        <!-- contigency this is required so that the references will actually appear in Visual Studio -->
        <Otherwise>
          <ItemGroup>
            <Reference Include="Kraken.SharePoint.FullTrust">
              <Private>True</Private>
            </Reference>
            <Reference Include="Kraken.SharePoint.SandboxTrust">
              <Private>True</Private>
            </Reference>
          </ItemGroup>
        </Otherwise>
      </Choose>

    </When>
    <When Condition="$(KrakenRef.Contains('SandboxSharePoint'))">

      <Choose>
        <!-- TODO need v16 references -->
        <!-- Debug and FxCop -->
        <When Condition="$(KrakenSharePointVersion.Contains('15')) AND ($(Configuration.Contains('Debug')) OR $(Configuration.Contains('FxCop')))">
          <ItemGroup>
            <Reference Include="Kraken.SharePoint.SandboxTrust, Version=15.0.0.0, Culture=neutral, PublicKeyToken=3cf55a8425a3a2ff, processorArchitecture=MSIL">
              <SpecificVersion>true</SpecificVersion>
              <HintPath>..\packages\Kraken.SharePoint.Client.0.1.10\lib\net45-full\Kraken.SharePoint.SandboxTrust.dll</HintPath>
              <Private>True</Private>
            </Reference>
          </ItemGroup>
        </When>
        <When Condition="$(KrakenSharePointVersion.Contains('14')) AND ($(Configuration.Contains('Debug')) OR $(Configuration.Contains('FxCop')))">
          <ItemGroup>
            <Reference Include="Kraken.SharePoint.SandboxTrust, Version=14.0.0.0, Culture=neutral, PublicKeyToken=3cf55a8425a3a2ff, processorArchitecture=MSIL">
              <SpecificVersion>true</SpecificVersion>
              <HintPath>..\packages\Kraken.SharePoint.Client.0.1.10\lib\net35-full\Kraken.SharePoint.SandboxTrust.dll</HintPath>
              <Private>True</Private>
            </Reference>
          </ItemGroup>
        </When>
        <!-- Release -->
        <When Condition="$(KrakenSharePointVersion.Contains('15')) AND $(Configuration.Contains('Release'))">
          <ItemGroup>
            <Reference Include="Kraken.SharePoint.SandboxTrust, Version=15.0.0.0, Culture=neutral, PublicKeyToken=3cf55a8425a3a2ff, processorArchitecture=MSIL">
              <SpecificVersion>true</SpecificVersion>
              <HintPath>..\packages\Kraken.SharePoint.Client.0.1.10\lib\net45-full\Kraken.SharePoint.SandboxTrust.dll</HintPath>
              <Private>True</Private>
            </Reference>
          </ItemGroup>
        </When>
        <When Condition="$(KrakenSharePointVersion.Contains('14')) AND $(Configuration.Contains('Release'))">
          <ItemGroup>
            <Reference Include="Kraken.SharePoint.SandboxTrust, Version=14.0.0.0, Culture=neutral, PublicKeyToken=3cf55a8425a3a2ff, processorArchitecture=MSIL">
              <SpecificVersion>true</SpecificVersion>
              <HintPath>..\packages\Kraken.SharePoint.Client.0.1.10\lib\net35-full\Kraken.SharePoint.SandboxTrust.dll</HintPath>
              <Private>True</Private>
            </Reference>
          </ItemGroup>
        </When>
        <!-- contigency this is required so that the references will actually appear in Visual Studio -->
        <Otherwise>
          <ItemGroup>
            <Reference Include="Kraken.SharePoint.SandboxTrust">
              <Private>True</Private>
            </Reference>
          </ItemGroup>
        </Otherwise>
      </Choose>

    </When>
  </Choose>
</Project>