<?xml version="1.0" encoding="utf-8"?>
<Project ToolsVersion="4.0" DefaultTargets="Build" xmlns="http://schemas.microsoft.com/developer/msbuild/2003">
  <!-- the following empty conditions are here to force VS.net to recognize the configurations that we want, because we're using Contains almost eveyplkace else -->
  <PropertyGroup Condition=" '$(Configuration)' == 'DebugSP14_35' ">
  </PropertyGroup>
  <PropertyGroup Condition=" '$(Configuration)' == 'DebugSP15_45' ">
  </PropertyGroup>
  <PropertyGroup Condition=" '$(Configuration)' == 'DebugSP16_45' ">
  </PropertyGroup>
  <PropertyGroup Condition=" '$(Configuration)' == 'FxCopSP14_35' ">
  </PropertyGroup>
  <PropertyGroup Condition=" '$(Configuration)' == 'FxCopSP15_45' ">
  </PropertyGroup>
  <PropertyGroup Condition=" '$(Configuration)' == 'FxCopSP16_45' ">
  </PropertyGroup>
  <PropertyGroup Condition=" '$(Configuration)' == 'ReleaseSP14_35' ">
  </PropertyGroup>
  <PropertyGroup Condition=" '$(Configuration)' == 'ReleaseSP15_45' ">
  </PropertyGroup>
  <PropertyGroup Condition=" '$(Configuration)' == 'ReleaseSP16_45' ">
  </PropertyGroup>
  <!-- 
	Problem in referencing these includes from a SharePoint project when they use $(SolutionDir) instead of $(MSBuildProjectDirectory)
	-->
  <Import Project="$(MSBuildProjectDirectory)\..\vsproj.include.KrakenCommon.xml" />
  <Import Project="$(MSBuildProjectDirectory)\..\vsproj.include.DebugRelease.xml" />
  <Import Project="$(MSBuildProjectDirectory)\..\vsproj.include.TargetFramework.xml" />
  <!-- ensure that we override the default configuration name from Bewoulf Common -->
  <PropertyGroup>
    <Configuration Condition=" '$(Configuration)' == '' ">DebugSP15_45</Configuration>
    <Platform Condition=" '$(Platform)' == '' ">AnyCPU</Platform>
    <TargetFrameworkVersion>v4.5</TargetFrameworkVersion>
    <TargetFrameworkProfile />
    <ActiveDeploymentConfiguration>No Activation</ActiveDeploymentConfiguration>
  </PropertyGroup>
  <!-- End: standard Kraken project build configurations -->
  <PropertyGroup>
    <!-- the purpose of this folder is to ensure that whatever version of the WSP we are building
	     it will have the correct versions of the DLLs that need to be packaged -->
    <PreBuildEvent>
    </PreBuildEvent>
    <PostBuildEvent>
		IF not exist "$(SolutionDir)References\Kraken\Package" mkdir "$(SolutionDir)References\Kraken\Package"
		DEL /Q /F "$(SolutionDir)References\Kraken\Package\*.dll"
		REM OutDir = $(OutDir)
		REM OutputPath = $(OutputPath)
		REM if "$(OutDir)"=="" (
		%windir%\System32\xcopy /Y /C /R ".\*.dll" "$(SolutionDir)References\Kraken\Package\"
		REM ) else (
		REM xcopy /Y /C /R "$(OutDir)*.dll" "$(SolutionDir)References\Kraken\Package\"
		REM )
	</PostBuildEvent>
  </PropertyGroup>
  <!-- the following custom property defines which SharePoint DLLs will be referenced in the include below -->
  <PropertyGroup>
    <SPRef>Core;Security;Moss;Profiles;Identity;Portal;Taxonomy</SPRef>
    <!-- ;AdminPages;ClientRuntime -->
  </PropertyGroup>
  <Import Project="$(SolutionDir)\vsproj.include.SharePoint.xml" />
  <Import Project="$(MSBuildExtensionsPath)\$(MSBuildToolsVersion)\Microsoft.Common.props" Condition="Exists('$(MSBuildExtensionsPath)\$(MSBuildToolsVersion)\Microsoft.Common.props')" />
  <PropertyGroup>
    <SchemaVersion>2.0</SchemaVersion>
    <ProjectGuid>{EC689A42-1C8E-40CD-8DF7-22A015875809}</ProjectGuid>
    <OutputType>Library</OutputType>
    <AppDesignerFolder>Properties</AppDesignerFolder>
    <RootNamespace>Kraken.SharePoint</RootNamespace>
    <AssemblyName>Kraken.SharePoint.FullTrust</AssemblyName>
    <ProjectTypeGuids>{C1CDDADD-2546-481F-9697-4EA41081F2FC};{14822709-B5A1-4724-98CA-57A101D1B079};{FAE04EC0-301F-11D3-BF4B-00C04F79EFBC}</ProjectTypeGuids>
    <SandboxedSolution>False</SandboxedSolution>
    <IncludeAssemblyInPackage>true</IncludeAssemblyInPackage>
    <IsWebBootstrapper>false</IsWebBootstrapper>
    <ProjectMode>SharePointCustomization</ProjectMode>
    <PublishUrl>publish\</PublishUrl>
    <Install>true</Install>
    <InstallFrom>Disk</InstallFrom>
    <UpdateEnabled>false</UpdateEnabled>
    <UpdateMode>Foreground</UpdateMode>
    <UpdateInterval>7</UpdateInterval>
    <UpdateIntervalUnits>Days</UpdateIntervalUnits>
    <UpdatePeriodically>false</UpdatePeriodically>
    <UpdateRequired>false</UpdateRequired>
    <MapFileExtensions>true</MapFileExtensions>
    <ApplicationRevision>0</ApplicationRevision>
    <ApplicationVersion>1.0.0.%2a</ApplicationVersion>
    <UseApplicationTrust>false</UseApplicationTrust>
    <BootstrapperEnabled>true</BootstrapperEnabled>
  </PropertyGroup>
  <PropertyGroup>
    <SignAssembly>true</SignAssembly>
    <AssemblyOriginatorKeyFile>key.snk</AssemblyOriginatorKeyFile>
  </PropertyGroup>
  <ItemGroup>
    <Reference Include="Microsoft.IdentityModel, Version=3.5.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35, processorArchitecture=MSIL" />
    <Reference Include="System" />
    <Reference Include="System.configuration" />
    <Reference Include="System.Core" />
    <Reference Include="System.Data" />
    <Reference Include="System.Data.DataSetExtensions" />
    <Reference Include="System.Net.Http" />
    <Reference Include="System.Net.Http.Extensions, Version=2.2.29.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a, processorArchitecture=MSIL">
      <HintPath>..\packages\Microsoft.Net.Http.2.2.29\lib\net45\System.Net.Http.Extensions.dll</HintPath>
      <Private>True</Private>
    </Reference>
    <Reference Include="System.Net.Http.Primitives, Version=4.2.29.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a, processorArchitecture=MSIL">
      <HintPath>..\packages\Microsoft.Net.Http.2.2.29\lib\net45\System.Net.Http.Primitives.dll</HintPath>
      <Private>True</Private>
    </Reference>
    <Reference Include="System.Net.Http.WebRequest" />
    <Reference Include="System.ServiceModel" />
    <Reference Include="System.Web" />
    <Reference Include="System.Web.Extensions" />
    <Reference Include="System.Xml" />
    <Reference Include="System.Xml.Linq" />
  </ItemGroup>
  <ItemGroup>
    <Compile Include="Configuration\Configuration.cs">
      <SubType>Code</SubType>
    </Compile>
    <Compile Include="Configuration\SPConfigurationListReader.cs" />
    <Compile Include="Configuration\SPConfigurationReader.cs" />
    <Compile Include="Configuration\SPFeatureListPropertyReaderBase.cs" />
    <Compile Include="Configuration\SPFeaturePropertyReaderBase.cs" />
    <Compile Include="Configuration\SPFeatureXmlTools.cs" />
    <Compile Include="Events\CopyFieldValueListItemEventReceiver.cs" />
    <Compile Include="Examples\ExampleFeatureProperties.cs" />
    <Compile Include="Examples\ExampleFeatureReceiver.cs" />
    <Compile Include="Extensions\SPContentTypeExtensions.cs" />
    <Compile Include="Extensions\SPFeatureExtensions.cs" />
    <Compile Include="Extensions\SPFieldExtensions.cs" />
    <Compile Include="Extensions\SPListExtensions.cs" />
    <Compile Include="Extensions\SPListItemExtensions.cs" />
    <Compile Include="Extensions\SPTrustedLoginProviderExtensions.cs" />
    <Compile Include="IdentityModel\AuthUrlTools.cs" />
    <Compile Include="IdentityModel\AutoRealmDiscoPageBase.cs">
      <SubType>ASPXCodeBehind</SubType>
    </Compile>
    <Compile Include="IdentityModel\MultiFactorAuthPageBase.cs">
      <SubType>ASPXCodeBehind</SubType>
    </Compile>
    <Compile Include="IdentityModel\LoginSelector.cs" />
    <Compile Include="IdentityModel\SPAuthExtensions.cs" />
    <Compile Include="Logging\KrakenLoggingService.cs" />
    <Compile Include="Logging\LoggingCategories.cs" />
    <Compile Include="Logging\LoggingCategoryProvider.cs" />
    <Compile Include="Logging\LoggingEventConsumerBase.cs" />
    <Compile Include="Logging\LoggingEventHandler.cs" />
    <Compile Include="Logging\LoggingEventHandlerExample.cs" />
    <Compile Include="Logging\LoggingExtensions.cs" />
    <Compile Include="Logging\Unsafe\DataDescriptorWrapper.cs" />
    <Compile Include="Logging\Unsafe\EVENT_DATA_DESCRIPTOR .cs" />
    <Compile Include="Logging\Unsafe\LegacyTraceProvider.cs" />
    <Compile Include="Logging\Unsafe\Payload.cs" />
    <Compile Include="Logging\Unsafe\SPCorrelationActivity.cs" />
    <Compile Include="Logging\Unsafe\SPTraceLogger.cs" />
    <Compile Include="Logging\Unsafe\TraceFlags.cs" />
    <Compile Include="Logging\Unsafe\TraceSeverity.cs" />
    <Compile Include="Mail\KrakenSmtpException.cs" />
    <None Include="app.config" />
    <None Include="DeployScripts\Deploy_Core_DevRed.ps1">
      <CopyToOutputDirectory>PreserveNewest</CopyToOutputDirectory>
    </None>
    <None Include="Images\SharePointProjectItem.spdata">
      <SharePointProjectItemId>{bd7a6bf6-6123-4a7b-a3a3-1c0bedf8b8ad}</SharePointProjectItemId>
    </None>
    <None Include="Mail\NO_COMPILE_MailMessage.cs" />
    <Compile Include="Properties\AssemblyInfo.cs" />
    <Compile Include="Provisioning\WebCreator.cs" />
    <Compile Include="IdentityModel\ClaimCookieExtensions.cs" />
    <Compile Include="Security\Delegation.cs" />
    <Compile Include="Security\EncryptionUtility.cs" />
    <Compile Include="UserProfiles\ProfilePropertyCreator.cs" />
    <Compile Include="UserProfiles\ProfileSecurityHelper.cs" />
    <Compile Include="UserProfiles\UserProfileUtilities.cs" />
    <Compile Include="UserProfiles\UserPropertyExtensions.cs" />
    <Compile Include="Users\SPUserExtensions.cs" />
    <Compile Include="Users\SPUserTools.cs" />
    <Compile Include="WebParts\Extensions\SPWebPartRequiredPropertyExtensions.cs">
      <SubType>Code</SubType>
    </Compile>
    <Compile Include="WebParts\Extensions\SPWebPartToolPaneExtensions.cs">
      <SubType>Code</SubType>
    </Compile>
    <Compile Include="WebParts\FlexBaseSPWebPart.cs" />
    <Compile Include="WebParts\ToolParts\CheckBoxListToolPartcs.cs" />
    <Compile Include="WebParts\ToolParts\FlexBaseToolPart.cs" />
    <Compile Include="WebParts\ToolParts\ListItemMultiPickerToolPart.cs" />
    <Compile Include="WebParts\ToolParts\ListItemPickerToolPart.cs" />
    <Compile Include="WebParts\ToolParts\SiteAndListPickerToolPart.cs" />
    <None Include="Package\Package.package">
      <PackageId>{9f398ceb-16e3-4de4-b61d-fab513277b51}</PackageId>
    </None>
    <None Include="packages.config" />
  </ItemGroup>
  <ItemGroup>
    <None Include="DeployScripts\SPDeployFunctions.ps1">
      <CopyToOutputDirectory>PreserveNewest</CopyToOutputDirectory>
    </None>
    <None Include="key.snk" />
  </ItemGroup>
  <ItemGroup>
    <Content Include="Images\Kraken.SharePoint\Blue-Kraken-icon.png" />
    <Content Include="Images\Kraken.SharePoint\Blue-Kraken-icon32.png" />
    <Content Include="Images\Kraken.SharePoint\Blue-Kraken-icon64.png" />
    <Content Include="Images\Kraken.SharePoint\Lightbrown-Kraken-icon.png" />
    <Content Include="Images\Kraken.SharePoint\Lightbrown-Kraken-icon32.png" />
    <Content Include="Images\Kraken.SharePoint\Lightbrown-Kraken-icon64.png" />
    <Content Include="Package\Package.Template.xml" />
    <Content Include="SPARK Copyleft.txt" />
  </ItemGroup>
  <ItemGroup>
    <Folder Include="Features\" />
  </ItemGroup>
  <ItemGroup>
    <ProjectReference Include="..\Kraken.Core.FullTrust\Kraken.Core.FullTrust.csproj">
      <Project>{757c7239-0e1b-41ba-aed5-7a15ac141042}</Project>
      <Name>Kraken.Core.FullTrust</Name>
    </ProjectReference>
    <ProjectReference Include="..\Kraken.Core.SandboxTrust\Kraken.Core.SandboxTrust.csproj">
      <Project>{dab0080d-c9b1-442e-84df-fc47ad8a442a}</Project>
      <Name>Kraken.Core.SandboxTrust</Name>
    </ProjectReference>
    <ProjectReference Include="..\Kraken.Core.Security\Kraken.Core.Security.csproj">
      <Project>{8340684f-3374-4741-af80-63af161e23df}</Project>
      <Name>Kraken.Core.Security</Name>
    </ProjectReference>
    <ProjectReference Include="..\Kraken.SPSandboxLibrary\Kraken.SPSandboxLibrary.csproj">
      <Project>{dff9b6ea-5c6e-4079-8506-181220fc7148}</Project>
      <Name>Kraken.SPSandboxLibrary</Name>
    </ProjectReference>
  </ItemGroup>
  <PropertyGroup>
    <VisualStudioVersion Condition="'$(VisualStudioVersion)' == ''">11.0</VisualStudioVersion>
    <VSToolsPath Condition="'$(VSToolsPath)' == ''">$(MSBuildExtensionsPath32)\Microsoft\VisualStudio\v$(VisualStudioVersion)</VSToolsPath>
  </PropertyGroup>
  <Import Project="$(MSBuildToolsPath)\Microsoft.CSharp.targets" />
  <Import Project="$(VSToolsPath)\SharePointTools\Microsoft.VisualStudio.SharePoint.targets" Condition="'$(VSToolsPath)' != ''" />
  <Import Project="$(MSBuildExtensionsPath32)\Microsoft\VisualStudio\v10.0\SharePointTools\Microsoft.VisualStudio.SharePoint.targets" Condition="false" />
  <Import Project="..\packages\Microsoft.Bcl.Build.1.0.21\build\Microsoft.Bcl.Build.targets" Condition="Exists('..\packages\Microsoft.Bcl.Build.1.0.21\build\Microsoft.Bcl.Build.targets')" />
  <Target Name="EnsureNuGetPackageBuildImports" BeforeTargets="PrepareForBuild">
    <PropertyGroup>
      <ErrorText>This project references NuGet package(s) that are missing on this computer. Use NuGet Package Restore to download them.  For more information, see http://go.microsoft.com/fwlink/?LinkID=322105. The missing file is {0}.</ErrorText>
    </PropertyGroup>
    <Error Condition="!Exists('..\packages\Microsoft.Bcl.Build.1.0.21\build\Microsoft.Bcl.Build.targets')" Text="$([System.String]::Format('$(ErrorText)', '..\packages\Microsoft.Bcl.Build.1.0.21\build\Microsoft.Bcl.Build.targets'))" />
  </Target>
</Project>